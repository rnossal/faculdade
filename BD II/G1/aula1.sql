CREATE TABLE TbDestino (
  PkIdDestino INTEGER NOT NULL,
  NomeDestino VARCHAR(100) NOT NULL UNIQUE,
  CONSTRAINT TbDestinoPk PRIMARY KEY (PkIdDestino)
);

CREATE TABLE TbAeronave (
  PkIdAeronave INTEGER NOT NULL,
  AnoFrabricacao DATE NOT NULL,
  Modelo VARCHAR(100) NOT NULL,
  NumeroVoos INTEGER,
  HorasVoo INTEGER NOT NULL,
  CONSTRAINT HorasVooCheck CHECK (HorasVoo BETWEEN 0 AND 40000),
  CONSTRAINT TbAeronavePk PRIMARY KEY (PkIdAeronave)
);

CREATE TABLE TbVoo (
  PkIdVoo INTEGER NOT NULL,
  Origem INTEGER NOT NULL,
  Destino INTEGER NOT NULL,
  NumeroVoo VARCHAR(20) NOT NULL ,
  DataSaida DATE NOT NULL,
  DataChegada DATE NOT NULL,
  QuantidadePoltronas INTEGER DEFAULT 120,
  QuantidadeLugaresOcupados INTEGER DEFAULT 0,
  CONSTRAINT TbVooPk PRIMARY KEY (PkIdVoo),
  CONSTRAINT QuantidadeLugaresCheck CHECK (QuantidadeLugaresOcupados <= QuantidadePoltronas),
  CONSTRAINT OrigemFk FOREIGN KEY (Origem) REFERENCES TbDestino(PkIdDestino) ON DELETE CASCADE,
  CONSTRAINT DestinoFk FOREIGN KEY (Destino) REFERENCES TbDestino(PkIdDestino) ON DELETE CASCADE
);

CREATE TABLE TbCliente(
  PkIdCliente INTEGER NOT NULL,
  Nome VARCHAR(100) NOT NULL,
  Endereco VARCHAR(100),
  Bairro VARCHAR(100),
  Cidade VARCHAR(100),
  CPF VARCHAR(11) NOT NULL,
  Idade INTEGER,
  Sexo VARCHAR(1) NOT NULL,
  NomeMae VARCHAR(100),
  QuantidadeReservas INTEGER DEFAULT 0,
  QuantaideCancelamentos INTEGER DEFAULT 0,
  CONSTRAINT SexoCheck CHECK (Sexo in ('M', 'F')),
  CONSTRAINT QuantidadeReservasCheck CHECK (QuantidadeReservas >= 0),
  CONSTRAINT QuantaideCancelamentosCheck CHECK (QuantaideCancelamentos >= 0),
  CONSTRAINT TbIdClientePk PRIMARY KEY (PkIdCliente)
);

CREATE TABLE TbReserva(
  PkIdReserva INTEGER NOT NULL,
  FkIdVoo INTEGER NOT NULL,
  FkCodCli INTEGER NOT NULL,
  NumPoltrona INTEGER,
  Status INTEGER,
  CONSTRAINT VooFk FOREIGN KEY (FkIdVoo) REFERENCES TbVoo(PkIdVoo) ON DELETE CASCADE,
  CONSTRAINT CodcliFk FOREIGN KEY (FkCodCli) REFERENCES TbCliente(PkIdCliente) ON DELETE CASCADE,
  CONSTRAINT TbReservaPk PRIMARY KEY (PkIdReserva)
);

INSERT INTO TbDestino VALUES (1,'Gravatai');
INSERT INTO TbDestino VALUES (2, 'Poa');
INSERT INTO TbDestino VALUES (3, 'Canoas');
INSERT INTO TbDestino VALUES (4, 'Caxias');
INSERT INTO TbDestino VALUES (5, 'Pelotas');

INSERT INTO TbAeronave VALUES (1, '01-01-2017', 'Modelo1', 0, 1000);
INSERT INTO TbAeronave VALUES (2, '01-02-2017', 'Modelo2',0, 2000);
INSERT INTO TbAeronave VALUES (3, '01-03-2017', 'Modelo3',0, 3000);
INSERT INTO TbAeronave VALUES (4, '01-04-2017', 'Modelo4',0, 5000);
INSERT INTO TbAeronave VALUES (5, '01-05-2017', 'Modelo5',0, 5000);

INSERT INTO TbVoo VALUES (1, 5, 3, 5, '01-01-2017', '05-05-2017', 5, 2);
INSERT INTO TbVoo VALUES (2, 5, 3, 5, '01-01-2017', '05-05-2017', 5, 2);
INSERT INTO TbVoo VALUES (3, 2, 4, 5, '01-01-2017', '05-05-2017', 5, 2);
INSERT INTO TbVoo VALUES (4, 2, 2, 5, '01-01-2017', '05-05-2017', 5, 2);
INSERT INTO TbVoo VALUES (5, 4, 1, 5, '01-01-2017', '05-05-2017', 5, 2);

INSERT INTO TbCliente VALUES (1, 'JOAO', 'RUA DOS BOBOS', 'ULBRA', 'GRAVATAI', '11111111111', 20, 'M', 'JOANA', 5,2);
INSERT INTO TbCliente VALUES (2, 'JOSE', 'RUA DOS LOUCOS', 'ULBRA', 'GRAVATAI', '11111111111', 20, 'M', 'JOANADARK', 5,2);
INSERT INTO TbCliente VALUES (3, 'MARIA', 'RUA DOS EVANGELICOS', 'ULBRAULBRA', 'CANOAS', '11111111111', 20, 'F', 'JOANA', 10,5);
INSERT INTO TbCliente VALUES (4, 'JUDAS', 'RUA DOS RETARDADOS', 'ULBRAGTI', 'GRAVATAI', '11111111111', 20, 'M', 'JOANA', 100,50);
INSERT INTO TbCliente VALUES (5, 'GODOFREDA', 'RUA DOS DOENTES', 'ULBRACANOAS', 'GRAVATAI', '11111111111', 20, 'M', 'JOANA', 120,2);

INSERT INTO TbReserva VALUES (1, 1,1,10,2);
INSERT INTO TbReserva VALUES (2, 2,2,20,1);
INSERT INTO TbReserva VALUES (3, 3,3,30,5);
INSERT INTO TbReserva VALUES (4, 4,4,40,8);
INSERT INTO TbReserva VALUES (5, 5,5,50,20);
